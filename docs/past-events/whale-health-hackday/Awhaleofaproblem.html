<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_uqpw1x3evnxm-8{list-style-type:none}.lst-kix_wt5qudh13a7d-6>li:before{content:"\0025cf   "}.lst-kix_f1av0htfqcu4-2>li:before{content:"\0025a0   "}.lst-kix_h3a3jyugzi3z-2>li:before{content:"\0025a0   "}.lst-kix_h3a3jyugzi3z-0>li:before{content:"\0025cf   "}.lst-kix_h3a3jyugzi3z-4>li:before{content:"\0025cb   "}.lst-kix_wt5qudh13a7d-3>li:before{content:"\0025cf   "}.lst-kix_wt5qudh13a7d-7>li:before{content:"\0025cb   "}.lst-kix_f1av0htfqcu4-1>li:before{content:"\0025cb   "}.lst-kix_f1av0htfqcu4-5>li:before{content:"\0025a0   "}.lst-kix_h3a3jyugzi3z-1>li:before{content:"\0025cb   "}.lst-kix_h3a3jyugzi3z-5>li:before{content:"\0025a0   "}.lst-kix_wt5qudh13a7d-2>li:before{content:"\0025a0   "}.lst-kix_f1av0htfqcu4-6>li:before{content:"\0025cf   "}ul.lst-kix_wt5qudh13a7d-0{list-style-type:none}.lst-kix_wt5qudh13a7d-0>li:before{content:"\0025cf   "}ul.lst-kix_wt5qudh13a7d-3{list-style-type:none}.lst-kix_wt5qudh13a7d-8>li:before{content:"\0025a0   "}.lst-kix_f1av0htfqcu4-0>li:before{content:"\0025cf   "}.lst-kix_f1av0htfqcu4-8>li:before{content:"\0025a0   "}ul.lst-kix_wt5qudh13a7d-4{list-style-type:none}.lst-kix_wt5qudh13a7d-1>li:before{content:"\0025cb   "}ul.lst-kix_wt5qudh13a7d-1{list-style-type:none}.lst-kix_f1av0htfqcu4-7>li:before{content:"\0025cb   "}.lst-kix_h3a3jyugzi3z-3>li:before{content:"\0025cf   "}ul.lst-kix_wt5qudh13a7d-2{list-style-type:none}ul.lst-kix_wt5qudh13a7d-7{list-style-type:none}ul.lst-kix_wt5qudh13a7d-8{list-style-type:none}ul.lst-kix_wt5qudh13a7d-5{list-style-type:none}ul.lst-kix_wt5qudh13a7d-6{list-style-type:none}.lst-kix_h3a3jyugzi3z-8>li:before{content:"\0025a0   "}ul.lst-kix_uqpw1x3evnxm-0{list-style-type:none}.lst-kix_h3a3jyugzi3z-6>li:before{content:"\0025cf   "}ul.lst-kix_uqpw1x3evnxm-1{list-style-type:none}ul.lst-kix_uqpw1x3evnxm-2{list-style-type:none}ul.lst-kix_uqpw1x3evnxm-3{list-style-type:none}ul.lst-kix_uqpw1x3evnxm-4{list-style-type:none}.lst-kix_f1av0htfqcu4-4>li:before{content:"\0025cb   "}ul.lst-kix_uqpw1x3evnxm-5{list-style-type:none}ul.lst-kix_uqpw1x3evnxm-6{list-style-type:none}.lst-kix_f1av0htfqcu4-3>li:before{content:"\0025cf   "}.lst-kix_h3a3jyugzi3z-7>li:before{content:"\0025cb   "}ul.lst-kix_uqpw1x3evnxm-7{list-style-type:none}.lst-kix_wt5qudh13a7d-4>li:before{content:"\0025cb   "}ul.lst-kix_f1av0htfqcu4-8{list-style-type:none}.lst-kix_uqpw1x3evnxm-7>li:before{content:"-  "}.lst-kix_wt5qudh13a7d-5>li:before{content:"\0025a0   "}ul.lst-kix_f1av0htfqcu4-7{list-style-type:none}ul.lst-kix_f1av0htfqcu4-6{list-style-type:none}.lst-kix_uqpw1x3evnxm-8>li:before{content:"-  "}ul.lst-kix_f1av0htfqcu4-5{list-style-type:none}ul.lst-kix_f1av0htfqcu4-4{list-style-type:none}ul.lst-kix_f1av0htfqcu4-3{list-style-type:none}ul.lst-kix_f1av0htfqcu4-2{list-style-type:none}.lst-kix_uqpw1x3evnxm-6>li:before{content:"-  "}ul.lst-kix_f1av0htfqcu4-1{list-style-type:none}ul.lst-kix_f1av0htfqcu4-0{list-style-type:none}.lst-kix_uqpw1x3evnxm-5>li:before{content:"-  "}.lst-kix_uqpw1x3evnxm-4>li:before{content:"-  "}.lst-kix_uqpw1x3evnxm-3>li:before{content:"-  "}.lst-kix_uqpw1x3evnxm-0>li:before{content:"-  "}.lst-kix_uqpw1x3evnxm-2>li:before{content:"-  "}.lst-kix_uqpw1x3evnxm-1>li:before{content:"-  "}ul.lst-kix_h3a3jyugzi3z-0{list-style-type:none}ul.lst-kix_h3a3jyugzi3z-1{list-style-type:none}ul.lst-kix_h3a3jyugzi3z-2{list-style-type:none}ul.lst-kix_h3a3jyugzi3z-3{list-style-type:none}ul.lst-kix_h3a3jyugzi3z-4{list-style-type:none}ul.lst-kix_h3a3jyugzi3z-5{list-style-type:none}ul.lst-kix_h3a3jyugzi3z-6{list-style-type:none}ul.lst-kix_h3a3jyugzi3z-7{list-style-type:none}ul.lst-kix_h3a3jyugzi3z-8{list-style-type:none}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol{margin:0;padding:0}table td,table th{padding:0}.c3{-webkit-text-decoration-skip:none;color:#000000;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:15pt;font-family:"Arial";font-style:normal}.c10{-webkit-text-decoration-skip:none;color:#000000;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:22pt;font-family:"Arial";font-style:normal}.c14{-webkit-text-decoration-skip:none;color:#000000;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-family:"Arial";font-style:normal}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Arial";font-style:normal}.c18{padding-top:20pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c2{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c16{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c17{color:#000000;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:normal}.c23{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c15{text-decoration-skip-ink:none;font-size:22pt;-webkit-text-decoration-skip:none;text-decoration:underline}.c19{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c4{padding:0;margin:0}.c21{font-weight:400;font-size:22pt}.c13{color:inherit;text-decoration:inherit}.c8{font-size:15pt;font-weight:700}.c12{margin-left:36pt;padding-left:0pt}.c20{font-weight:400;font-size:20pt}.c11{margin-left:72pt;padding-left:0pt}.c9{font-weight:700}.c7{font-size:10pt}.c22{font-size:15pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c19 doc-content"><p class="c16"><span class="c15">A whale of a </span><span class="c15">problem</span><span class="c10">! </span></p><p class="c16"><span class="c17 c21">ML Squamish Hackday</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 284.00px;"><img alt="" src="images/image2.png" style="width: 601.70px; height: 284.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1"></span></p><p class="c5"><span class="c8">GitHub</span><span class="c22">: </span><span class="c23 c22"><a class="c13" href="https://www.google.com/url?q=https://github.com/MLSquamish/whale-health-hackday&amp;sa=D&amp;source=editors&amp;ust=1719541089706393&amp;usg=AOvVaw2yaYtuOppcq1Rn5Ihf64gJ">https://github.com/MLSquamish/whale-health-hackday</a></span><span class="c1">&nbsp;</span></p><p class="c2"><span class="c1"></span></p><p class="c2"><span class="c14 c7"></span></p><hr style="page-break-before:always;display:none;"><p class="c2"><span class="c7 c14"></span></p><p class="c5"><span class="c3">Brainstorming session outcomes:</span></p><p class="c2"><span class="c3"></span></p><p class="c5"><span class="c0">Separated the task into two possible approaches </span></p><p class="c5"><span class="c0">- detecting whale locations</span></p><p class="c5"><span class="c0">- finding the flattest / longest / largest image of that whale in a given frame</span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 453.33px;"><img alt="" src="images/image3.jpg" style="width: 601.70px; height: 453.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span class="c7 c9">Whale detection </span><span class="c0">could be done using a bounding box supervised learning approach such as yolo, or by using the segments output by a segmentation model. <br></span></p><p class="c5"><span class="c0">Measurement could be approached using the hypotenuse of the bounding box output of a yolo model, or by counting the pixels within a segment <br><br>Looked at options for segmentation and found Segment Anything as a general purpose segmentation model which looked better and faster to get working than any custom approaches. </span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span class="c9 c7 c17">Best whale frame</span></p><p class="c5"><span class="c0">Suggested approaches - edge detection, k means, anomaly detection, color thresholding, optical flow segmentation. </span></p><hr style="page-break-before:always;display:none;"><p class="c2"><span class="c0"></span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span class="c17 c8">Things learned: </span></p><ul class="c4 lst-kix_h3a3jyugzi3z-0 start"><li class="c5 c12 li-bullet-0"><span class="c23 c7"><a class="c13" href="https://www.google.com/url?q=https://www.kaggle.com/code/danpresil1/segment-anything-model-sam-prompt-examples&amp;sa=D&amp;source=editors&amp;ust=1719541089708147&amp;usg=AOvVaw3kWsvJ7HRzOuxIN9vcLIAK">Segment Anything</a></span><span class="c7">&nbsp;is pretty damn good </span></li></ul><ul class="c4 lst-kix_h3a3jyugzi3z-1 start"><li class="c5 c11 li-bullet-0"><span class="c0">A lot of potential </span></li><li class="c5 c11 li-bullet-0"><span class="c0">Had difficulty making it work locally</span></li></ul><ul class="c4 lst-kix_h3a3jyugzi3z-0"><li class="c5 c12 li-bullet-0"><span class="c7">There has been a past challenge for </span><span class="c7 c23"><a class="c13" href="https://www.google.com/url?q=https://www.kaggle.com/competitions/happy-whale-and-dolphin&amp;sa=D&amp;source=editors&amp;ust=1719541089708656&amp;usg=AOvVaw2o5vBys-q2C7-jsnbLzQxC">whale and dolphin identification</a></span><span class="c0">&nbsp;which used it.</span></li></ul><p class="c2"><span class="c0"></span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 284.00px;"><img alt="" src="images/image2.png" style="width: 601.70px; height: 284.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c0">Video still processed with segment-anything to generate masks</span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 356.00px;"><img alt="" src="images/image5.png" style="width: 601.70px; height: 356.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c0">Segment-anything was able to distinguish whales even when they overlap in the frame.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 560.00px; height: 411.00px;"><img alt="" src="images/image6.png" style="width: 560.00px; height: 411.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0">Plotting the brightness(gray) and size of the bounding boxes(purple) over time, as a way to explore choosing the best frame for the flattest whale.</span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span class="c0">We were hoping that the brightest frame would be when the whale is on the surface and flat. Another idea was when the box was the biggest, it would be represent the whale being on the surface and flat.</span></p><p class="c5"><span class="c0"><br>Because we were averaging the brightness over the entire bounding box, including the water and the whale, we did not see a good correlation of the brightest sections with flat whale sections.</span></p><p class="c5"><span class="c0">Similarly, with the bounding box not being perfect, we saw little correlation between size of box and best whale frame.<br></span></p><p class="c5"><span class="c0">We think with a better segmentation method than the noisy bounding box data, we may have better luck here.</span></p><h1 class="c18" id="h.ac5dtof0l7ly"><span class="c17 c20">An approach that could solve David&rsquo;s problem</span></h1><p class="c2"><span class="c6"></span></p><p class="c5"><span class="c6">First of all, what is David&rsquo;s problem?</span></p><p class="c5"><span class="c6">As we understand it - David&rsquo;s problem is to find out how fat whales are as efficiently as possible. &nbsp;</span></p><p class="c2"><span class="c6"></span></p><p class="c5"><span>Since weighing them is impractical, one could just use pixel-area and drone-altitude to estimate whale mass.</span></p><p class="c2"><span class="c0"></span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span class="c17 c9 c7">Possible approach to solution:</span></p><ul class="c4 lst-kix_uqpw1x3evnxm-0 start"><li class="c5 c12 li-bullet-0"><span class="c9 c7">[Whale segmentation] </span><span class="c0">Segment frames using Segment Anything model to get masks of whales</span></li></ul><ul class="c4 lst-kix_uqpw1x3evnxm-1 start"><li class="c5 c11 li-bullet-0"><span class="c0">TODO: Clarify steps to get from segments to actual mass of individual whales. </span></li></ul><ul class="c4 lst-kix_uqpw1x3evnxm-0"><li class="c5 c12 li-bullet-0"><span class="c9 c7">[Tracking] </span><span class="c0">&ldquo;Track&rdquo; a given whale using overlap between subsequent frames. &nbsp;</span></li><li class="c5 c12 li-bullet-0"><span class="c17 c9 c7">[Measurement frame selection] </span></li></ul><ul class="c4 lst-kix_uqpw1x3evnxm-1 start"><li class="c5 c11 li-bullet-0"><span class="c0">&ldquo;Flat whale&rdquo; idea. &nbsp;We could do a linear regression on pixels-in-the segment and find the frame in which the whale fits best to a line. </span></li><li class="c5 c11 li-bullet-0"><span class="c7">&ldquo;Maximal area idea&rdquo;. &nbsp;Just use the frame where whale pixels occupy the maximal area. &nbsp;</span></li></ul><ul class="c4 lst-kix_uqpw1x3evnxm-0"><li class="c5 c12 li-bullet-0"><span class="c9 c7">[Weight Estimation] </span><span class="c7">The mask area should be a good measure of whale area <br></span><img src="images/image1.png"><span class="c0"><br>Where SomeConstant would </span></li></ul><p class="c2"><span class="c0"></span></p><p class="c5"><span class="c0">Holy grail:</span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span class="c0">System takes in MP4, drone altitude (SRT file?)</span></p><p class="c5"><span class="c0">Produces </span></p><ul class="c4 lst-kix_f1av0htfqcu4-0 start"><li class="c5 c12 li-bullet-0"><span class="c0">Per frame whale ID&rsquo;s and mass estimates</span></li><li class="c5 c12 li-bullet-0"><span class="c0">Video showing segmentation (e.g below)</span></li><li class="c2 c12 li-bullet-0"><span class="c0"></span></li></ul><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 339.23px;"><img alt="" src="images/image4.png" style="width: 601.70px; height: 339.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c0"></span></p><p class="c2"><span class="c0"></span></p><p class="c2"><span class="c0"></span></p><p class="c5"><span class="c17 c9 c7">Questions:</span></p><ul class="c4 lst-kix_wt5qudh13a7d-0 start"><li class="c5 c12 li-bullet-0"><span class="c0">If we can produce a &ldquo;maximum area&rdquo; for a whale, is that better than giving the &ldquo;best frame to measure&rdquo; since it will have already done the measuring?</span></li></ul><ul class="c4 lst-kix_wt5qudh13a7d-1 start"><li class="c5 c11 li-bullet-0"><span class="c0">We can still correlate it with the frame that was measured</span></li><li class="c5 c11 li-bullet-0"><span class="c0">Or is there something about measuring width at specific points on the whale&rsquo;s body that is necessary for the weight calculation?</span></li></ul></body></html>